# 图形学绘制练习项目

本项目是一个基于 Win32/GDI 的交互式绘图程序，内置多种基础图元与算法：直线（Bresenham/加粗/虚线）、圆/圆弧（中点法）、Bezier 曲线、B 样条、扫描线填充、直线段裁剪（Cohen–Sutherland）、凸多边形裁剪窗等。支持选择并对对象做平移/旋转/缩放等变换。

## 构建与运行

- 平台：Windows（Win32 桌面程序）
- 编译器：MSVC（建议 Visual Studio 2019/2022）
- 方式一（推荐）：使用 Visual Studio 打开工程/文件夹，配置为 Windows 桌面应用并编译运行。
- 方式二：将 `*.cpp`/`*.h` 加入到你自己的 Win32 空工程中（字符集与子系统选择“Windows”），然后编译运行。

程序窗口打开后会创建后台缓冲并渲染当前场景中的对象。大多数绘制交互为“左键开始/预览，左键结束”，完成后对象会加入场景并被持久显示。

## 基本操作

- 左键：按模式不同用于“开始/追加/结束”一次绘制，或在选择模式下开始/结束一次变换。
- 右键：在选择模式下用于选择/取消选择对象；在多边形/裁剪窗模式下用于结束输入。
- 鼠标移动：在绘制或变换过程中实时预览效果。
- 空格键：中断当前操作（不会清空画布）。
- Esc：中断并切回“选择模式”。

## 模式与热键

切换模式后请按提示进行相应的鼠标交互。模式切换不会清空已完成的对象。

- L：直线模式（Line）
  - 操作：左键一次设置起点，移动鼠标预览，左键再次设置终点完成。
  - 附加：1/2/4 切换线宽；D 开启虚线；S 关闭虚线。

- C：圆模式（Circle）
  - 操作：左键一次设置圆心，移动鼠标预览半径，左键再次完成。
  - A：在圆模式下按 A 进入“圆弧模式（Arc-Circle）”。

- A（在圆模式下）：圆弧模式（Arc-Circle）
  - 操作：
    1) 左键设置圆心；
    2) 左键设置半径并确定起始角；
    3) 左键设置终止角完成。

- B：Bezier 曲线模式
  - 操作：
    - 录入：依次左键添加控制点，靠近上一个控制点左击可结束录入转入“编辑模式”。
    - 编辑：左击选中某个控制点后可拖动调整，左击释放位置以确认。
  - S：从 Bezier 模式切换到 B 样条模式（Bspline）。

- S（在 Bezier 模式下）：B 样条模式（Bspline）
  - 操作与 Bezier 类似：左键添加控制点；靠近上一个控制点结束录入后可编辑控制点位置。

- M：多边形模式（Polygon）
  - 操作：左键依次添加顶点；右键结束并生成多边形轮廓；按住 Shift 再右键则对多边形进行填充。
  - 说明：构建过程中仅记录顶点，完成时一次性绘制所有边/填充。

- F：扫描线区域填充（种子填充）
  - 操作：左键在画布上点击一个种子点，对当前未被占用的区域进行填充。

- K：直线段裁剪
  - 操作：左键依次点击两点定义线段；若已设置凸裁剪窗，则使用多边形窗口裁剪；否则使用画布矩形做 Cohen–Sutherland 裁剪。保留部分以红色显示。

- O：凸多边形裁剪窗口
  - 操作：左键依次添加顶点；右键结束并生成红色轮廓的裁剪窗口。随后在“直线段裁剪（K）”模式中将使用该窗口。

- 选择模式（默认）
  - 进入方式：启动程序默认是选择模式；或按 Esc 回到选择模式。
  - 选择/反选：右键点击对象。
  - 变换：
    - T：切换为平移；
    - R：切换为旋转；
    - Z：切换为缩放。
    - 左键一次开始变换，移动鼠标预览，左键再次确认。
  - 中心点：Ctrl+P 恢复几何中心并取消“固定中心”。选中对象时会显示中心点标记。
  - 删除：Delete 键删除选中对象。

## 快捷键速查

- 模式：L 直线、C 圆、B Bezier、S（Bezier→Bspline）、M 多边形、F 填充、K 线裁剪、O 裁剪窗、Esc 选择。
- 直线样式：1/2/4 线宽，D 开启虚线，S 关闭虚线。
- 选择/变换：T 平移，R 旋转，Z 缩放，Ctrl+P 取消固定中心，Delete 删除，Space 中断。
- 多边形：右键结束；Shift+右键 填充。

## 文件结构（简要）

- `GraphicsEngine.*`：渲染与对象链管理、双缓冲绘制。
- `Objects.*`：图元定义与绘制、几何变换。
- `Algorithms/`：基础算法（Bresenham、Midpoint、de Casteljau、B 样条、扫描线、裁剪等）。
- `Actions.*`：交互/模式状态机与事件处理（键鼠）。

## 说明

- 本项目主要用于图形学与几何处理的算法练习，交互设计以演示算法为主。
- 若你的键盘布局或输入法会拦截部分按键，请在系统层面调整或改用其他快捷键（可在 `Actions.cpp` 中修改）。

如需在 README 中补充动图或截图示例，告诉我我可以添加相应的使用示例与说明。
